<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>heqiao2010</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="blog of heqiao2010">
<meta property="og:type" content="website">
<meta property="og:title" content="heqiao2010">
<meta property="og:url" content="http://heqiao2010.github.io/page/3/index.html">
<meta property="og:site_name" content="heqiao2010">
<meta property="og:description" content="blog of heqiao2010">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="heqiao2010">
<meta property="article:tag" content="java,go">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="heqiao2010" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">heqiao2010</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://heqiao2010.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-Java垃圾回收" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/18/Java%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/" class="article-date">
  <time datetime="2018-06-18T10:00:00.000Z" itemprop="datePublished">2018-06-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%9C%8D%E5%8A%A1%E7%AB%AF/">服务端</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/18/Java%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/">Java垃圾回收</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://img.hacpai.com/bing/20180112.jpg?imageView2/1/w/960/h/520/interlace/1/q/100"></p>
<blockquote>
<p>在目前我参与的实际项目开发中，启动Java进程时，并没有设置额外的虚拟机参数。因为公司通过k8s集群给我们自己的业务微服务打了标签，基本上时独享整个机器的内存，所以没有增加相关的JVM参数，对这块了解也不多。在上一家公司工作的时候，测试内存溢出用的是Jprofile，运行一段时间之后，手动触发GC，看内存是否增长。</p>
</blockquote>
<h3 id="Java虚拟机内存分区"><a href="#Java虚拟机内存分区" class="headerlink" title="Java虚拟机内存分区"></a>Java虚拟机内存分区</h3><p>Java虚拟机主要分为以下五个区: </p>
<p>一、方法区： </p>
<p>1. 有时候也成为永久代，在该区内很少发生垃圾回收，但是并不代表不发生GC，在这里进行的GC主要是对方法区里的常量池和对类型的卸载<br>2. 方法区主要用来存储已被虚拟机加载的类的信息、常量、静态变量和即时编译器编译后的代码等数据。<br>3. 该区域是被线程共享的。<br>4. 方法区里有一个运行时常量池，用于存放静态编译产生的字面量和符号引用。该常量池具有动态性，也就是说常量并不一定是编译时确定，运行时生成的常量也会存在这个常量池中。</p>
<p>二、堆 </p>
<p>java堆是所有线程所共享的一块内存，在虚拟机启动时创建，几乎所有的对象实例都在这里创建，因此该区域经常发生垃圾回收操作。</p>
<p>三、虚拟机栈: </p>
<p>1. 虚拟机栈也就是我们平常所称的栈内存,它为java方法服务，每个方法在执行的时候都会创建一个栈帧，用于存储局部变量表、操作数栈、动态链接和方法出口等信息。<br>2. 虚拟机栈是线程私有的，它的生命周期与线程相同。<br>3. 局部变量表里存储的是基本数据类型、returnAddress类型（指向一条字节码指令的地址）和对象引用，这个对象引用有可能是指向对象起始地址的一个指针，也有可能是代表对象的句柄或者与对象相关联的位置。局部变量所需的内存空间在编译器间确定<br>4.操作数栈的作用主要用来存储运算结果以及运算的操作数，它不同于局部变量表通过索引来访问，而是压栈和出栈的方式<br>5.每个栈帧都包含一个指向运行时常量池中该栈帧所属方法的引用，持有这个引用是为了支持方法调用过程中的动态连接.动态链接就是将常量池中的符号引用在运行期转化为直接引用。</p>
<p>四、本地方法区 </p>
<p>本地方法区和虚拟机栈类似，只不过本地方法栈为Native方法（对非java语言调用的接口）服务。</p>
<p>五、程序计数器 </p>
<p>内存空间小，字节码解释器工作时通过改变这个计数值可以选取下一条需要执行的字节码指令，分支、循环、跳转、异常处理和线程恢复等功能都需要依赖这个计数器完成。该内存区域是唯一一个java虚拟机规范没有规定任何OOM情况的区域。</p>
<h3 id="垃圾回收的特点"><a href="#垃圾回收的特点" class="headerlink" title="垃圾回收的特点"></a>垃圾回收的特点</h3><p>程序计数器、虚拟机栈、本地方法栈这3个区域是随线程而生而灭的，内存分配和回收都具备确定性，而Java堆和方法区则不一样，各线程共享，在运行时内存的分配与回收都是动态的，垃圾收集器所关注的是这部分内存。</p>
<h3 id="了解垃圾回收机制的必要性"><a href="#了解垃圾回收机制的必要性" class="headerlink" title="了解垃圾回收机制的必要性"></a>了解垃圾回收机制的必要性</h3><p>虽然垃圾回收机制已经比较成熟和稳定，但是当遇到如下情况时，就必须关注垃圾回收机制本身了。</p>
<ol>
<li>当需要排查各种内存溢出、内存泄漏问题时；</li>
<li>当垃圾收集成为系统达到更高并发量的瓶颈时；</li>
</ol>
<h3 id="垃圾回收算法做的事情"><a href="#垃圾回收算法做的事情" class="headerlink" title="垃圾回收算法做的事情"></a>垃圾回收算法做的事情</h3><ol>
<li>回收什么</li>
<li>什么时候回收</li>
<li>怎么回收</li>
</ol>
<h4 id="1-回收什么"><a href="#1-回收什么" class="headerlink" title="1. 回收什么"></a>1. 回收什么</h4><ol>
<li>引用计数算法（Recference Counting）</li>
</ol>
<p><strong>思路:</strong> 给对象添加一个引用计数器，每当有一个地方引用它，计数器加1；当引用失效，计数器值减1；任何时刻计数器值为0，则认为对象是不再被使用的；<br><strong>优点:</strong> 实现简单，判定高效，可以很好解决大部分场景的问题;<br><strong>缺点:</strong> 1)很难解决对象之间相互循环引用的问题 2)开销较大，频繁且大量的引用变化，带来大量的额外运算;</p>
<p>参考1：<a target="_blank" rel="noopener" href="https://blog.csdn.net/tjiyu/article/details/53982412">https://blog.csdn.net/tjiyu/article/details/53982412</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://heqiao2010.github.io/2018/06/18/Java%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/" data-id="ckgkq4js5000bhvwwfhd2chjs" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-TCP链接数优化记录" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/15/TCP%E9%93%BE%E6%8E%A5%E6%95%B0%E4%BC%98%E5%8C%96%E8%AE%B0%E5%BD%95/" class="article-date">
  <time datetime="2018-06-15T10:00:00.000Z" itemprop="datePublished">2018-06-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%9C%8D%E5%8A%A1%E7%AB%AF/">服务端</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/15/TCP%E9%93%BE%E6%8E%A5%E6%95%B0%E4%BC%98%E5%8C%96%E8%AE%B0%E5%BD%95/">TCP链接数优化记录</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://img.hacpai.com/bing/20171207.jpg?imageView2/1/w/960/h/520/interlace/1/q/10"> </p>
<blockquote>
<p>之前在开发无线wifi认证系统的时候，遇到一次性能问题，表现就是前端3台nginx返回大量502和504，所有接口返回慢，包括html，css以及js等资源文件的响应也很慢。在后端服务器上，用<code>netstat</code>查看发现有大量数据阻塞在接收队列，服务器处理不过来，同时TCP链接数很多，不过后端服务器的CPU以及内存正常，所以之前怀疑是TCP链接数过多导致的，所以后续采取了一些方法来，减少后端服务器和前端nginx之间的链接数。</p>
</blockquote>
<h3 id="查看TCP链接"><a href="#查看TCP链接" class="headerlink" title="查看TCP链接"></a>查看TCP链接</h3><ol>
<li>查看TCP链接总数<br>总体来说，TCP连接数偏多</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@portal-nginx2 ~]# netstat -an | grep ES| wc -l</span><br><span class="line">6326</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>查看TCP链接队列情况<br>如果接受队列阻塞了，说明后端服务处理请求太慢了，有性能问题；如果发送队列包很多，说明接收端有问题，或者虚机网络问题。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Active Internet connections (servers and established)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">tcp        0  10369 192.168.1.10:10080      100.125.64.100:16916    ESTABLISHED</span><br><span class="line">tcp        0  13169 192.168.1.10:10080      100.125.64.97:16809     ESTABLISHED</span><br><span class="line">tcp        0  13568 192.168.1.10:10080      100.125.64.96:17071     ESTABLISHED</span><br><span class="line">tcp        0  13595 192.168.1.10:10080      100.125.64.97:17074     ESTABLISHED</span><br><span class="line">tcp        0  13596 192.168.1.10:10080      100.125.64.98:17070     ESTABLISHED</span><br><span class="line">tcp        0  14600 192.168.1.10:10080      100.125.64.109:23059    ESTABLISHED</span><br><span class="line">tcp        0  14851 192.168.1.10:10080      100.125.64.103:23019    ESTABLISHED</span><br><span class="line">tcp        0  16157 192.168.1.10:10080      100.125.64.82:16914     ESTABLISHED</span><br><span class="line">tcp        0  17680 192.168.1.10:10443      100.125.64.104:18713    ESTABLISHED</span><br><span class="line">tcp        0  18653 192.168.1.10:10080      100.125.64.126:56441    ESTABLISHED</span><br><span class="line">tcp        0  19766 192.168.1.10:10443      100.125.64.114:18725    ESTABLISHED</span><br><span class="line">tcp        0  32120 192.168.1.10:10080      100.125.64.117:23044    ESTABLISHED</span><br><span class="line">tcp        0  45716 192.168.1.10:10443      100.125.64.113:18725    ESTABLISHED</span><br><span class="line">tcp        0  47955 192.168.1.10:10080      100.125.64.116:23033    ESTABLISHED</span><br><span class="line">tcp        0  54595 192.168.1.10:10080      100.125.64.90:16961     ESTABLISHED</span><br><span class="line">tcp        0  54600 192.168.1.10:10080      100.125.64.85:16961     ESTABLISHED</span><br><span class="line">tcp        0  62454 192.168.1.10:10080      100.125.64.149:46132    ESTABLISHED</span><br><span class="line">tcp        0  63689 192.168.1.10:10080      100.125.64.127:56506    ESTABLISHED</span><br></pre></td></tr></table></figure>



<h3 id="系统参数设置"><a href="#系统参数设置" class="headerlink" title="系统参数设置"></a>系统参数设置</h3><p>这几个系统参数，印象最深的是<code>net.ipv4.tcp_fin_timeout</code>,系统默认值是60，表示链接断开后，链接保持fin_wait的时间（我记得阿里的java开发规范里有提到这个）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@XXX ~]# cat &#x2F;etc&#x2F;sysctl.conf</span><br><span class="line"># sysctl settings are defined through files in</span><br><span class="line"># &#x2F;usr&#x2F;lib&#x2F;sysctl.d&#x2F;, &#x2F;run&#x2F;sysctl.d&#x2F;, and &#x2F;etc&#x2F;sysctl.d&#x2F;.</span><br><span class="line">#</span><br><span class="line"># Vendors settings live in &#x2F;usr&#x2F;lib&#x2F;sysctl.d&#x2F;.</span><br><span class="line"># To override a whole file, create a new file with the same in</span><br><span class="line"># &#x2F;etc&#x2F;sysctl.d&#x2F; and put new settings there. To override</span><br><span class="line"># only specific settings, add a file with a lexically later</span><br><span class="line"># name in &#x2F;etc&#x2F;sysctl.d&#x2F; and put new settings there.</span><br><span class="line">#</span><br><span class="line"># For more information, see sysctl.conf(5) and sysctl.d(5).</span><br><span class="line">net.ipv4.icmp_echo_ignore_broadcasts &#x3D; 1 #避免放大攻击</span><br><span class="line">net.ipv4.tcp_max_syn_backlog&#x3D;8192  #表示SYN队列的长度，默认为1024</span><br><span class="line">net.core.netdev_max_backlog&#x3D;30000   #进入包的最大设备队列.默认是1000</span><br><span class="line">net.core.somaxconn&#x3D;8192 #挂起请求的最大数量.默认是128.</span><br><span class="line">net.ipv4.ip_local_port_range &#x3D; 3000     65000  #端口范围，可用端口数</span><br><span class="line">net.ipv4.tcp_fin_timeout &#x3D; 30</span><br><span class="line">net.ipv4.tcp_max_tw_buckets&#x3D;5000 #表示系统同时保持TIME_WAIT套接字的最大数量</span><br></pre></td></tr></table></figure>

<p>修改完后，<code>sysctl -p</code>生效。</p>
<h3 id="反向代理设置"><a href="#反向代理设置" class="headerlink" title="反向代理设置"></a>反向代理设置</h3><p>nginx.conf中的upstream配置增加keepalive参数，keepalive后的参数是以秒为单位的时间。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">upstream portal &#123;</span><br><span class="line">            server 192.168.1.128:7878;</span><br><span class="line">            server 192.168.1.60:7878;</span><br><span class="line">            server 192.168.1.82:7878;</span><br><span class="line">            server 192.168.1.69:7878;</span><br><span class="line">            server 192.168.1.253:7878;</span><br><span class="line">            server 192.168.1.160:7878;</span><br><span class="line">            server 192.168.1.33:7878;</span><br><span class="line">            keepalive 500;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>这里谈到keepalive就想到了TCP的keepalive了，TCP的keepalive机制实际上是在没有数据传输的一个保活机制。TCP在3次握手之后，就可以开始传输数据了，但是当没有数据可传输的时候，为了知道对端是否还保持这个链接，TCP协议会定期发送一个数据为空的探测报文，看看对端是否会响应这个报文，如果不响应，则说明这个链接已经丢失了。TCP的keepalive可以设置TCP协议在没有数据传输后多久开始发送探测报文，以及发送探测报文重试次数等等。</p>
<p>实际上上面nginx.conf中，这个keepalive不是配置TCP探测报文的（nginx.conf中真正TCP探测报文的配置是通过<code>so_keepalive</code>控制的），这个keepalive的官方解释如下：</p>
<ol>
<li>The connections parameter sets the maximum number of idle keepalive connections to upstream servers connections（设置到upstream服务器的空闲keepalive连接的最大数量）</li>
<li>When this number is exceeded, the least recently used connections are closed. （当这个数量被突破时，最近使用最少的连接将被关闭）</li>
<li>It should be particularly noted that the keepalive directive does not limit the total number of connections to upstream servers that an nginx worker process can open.（特别提醒：keepalive指令不会限制一个nginx worker进程到upstream服务器连接的总数量）</li>
</ol>
<p>http的传输层协议是TCP，一个http请求是通过TCP传输的数据，当一个http请求发出，然后得到响应之后，TCP链接可能会关闭，下一次发起http请求时，再重新创建TCP链接，这个过程，必然会有TCP多次创建的过程，而创建过程会消耗额外资源。如果能够在一段时间内复用之前已经创建的TCP链接，则可以提升效率。这个超时时间可以通过nginx.conf中http部分的<code>keepalive_timeout</code>来控制。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keepalive_timeout timeout [header_timeout];</span><br></pre></td></tr></table></figure>

<p>参考1：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/xiaoleiel/p/8308514.html">https://www.cnblogs.com/xiaoleiel/p/8308514.html</a><br>参考2：<a target="_blank" rel="noopener" href="https://blog.csdn.net/dream_flying_bj/article/details/54709549">https://blog.csdn.net/dream_flying_bj/article/details/54709549</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://heqiao2010.github.io/2018/06/15/TCP%E9%93%BE%E6%8E%A5%E6%95%B0%E4%BC%98%E5%8C%96%E8%AE%B0%E5%BD%95/" data-id="ckgkq4jsj0013hvww0jg6adwb" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9C%8D%E5%8A%A1%E7%AB%AF/" rel="tag">服务端</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Shell实现的几个Http交互的方法" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/14/Shell%E5%AE%9E%E7%8E%B0%E7%9A%84%E5%87%A0%E4%B8%AAHttp%E4%BA%A4%E4%BA%92%E7%9A%84%E6%96%B9%E6%B3%95/" class="article-date">
  <time datetime="2018-06-14T10:00:00.000Z" itemprop="datePublished">2018-06-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%9C%8D%E5%8A%A1%E7%AB%AF/">服务端</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/14/Shell%E5%AE%9E%E7%8E%B0%E7%9A%84%E5%87%A0%E4%B8%AAHttp%E4%BA%A4%E4%BA%92%E7%9A%84%E6%96%B9%E6%B3%95/">Shell 实现的几个Http交互的方法</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://img.hacpai.com/bing/20171206.jpg?imageView2/1/w/960/h/520/interlace/1/q/10"> </p>
<blockquote>
<p>由于测试需求，需要测试一些http接口是否正常，作为后端开发可以用脚本语言来实现比如python,shell之类的，这里分享一下，用shell如何实现。</p>
</blockquote>
<ul>
<li><p>URLencode方法<br>既然是http接口，必定会用到urlencode来将参数放入URL中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">url_encode()&#123; </span><br><span class="line">  echo  &quot;$1&quot; | tr -d  &#39;\n&#39; | xxd -plain | sed &#39;s&#x2F;\(..\)&#x2F;%\1&#x2F;g&#39; | tr -d  &#39;\n&#39;  </span><br><span class="line">  return  0 </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>URLdecode方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">url_decode()&#123;</span><br><span class="line">        printf $(echo -n $t | sed &#39;s&#x2F;\\&#x2F;\\\\&#x2F;g;s&#x2F;\(%\)\([0-9a-fA-F][0-9a-fA-F]\)&#x2F;\\x\2&#x2F;g&#39;)</span><br><span class="line">        return 0</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>解析JSON数据，从JSON对象中获取某个属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">parse_json()&#123;</span><br><span class="line">    json&#x3D;&#96;echo $1 | sed &#39;s&#x2F;\&quot;&#x2F;&#x2F;g&#39;&#96;; #remove quotation mark</span><br><span class="line">    echo $json | sed &#39;s&#x2F;.*&#39;$2&#39;:\([^,&#125;]*\).*&#x2F;\1&#x2F;&#39;</span><br><span class="line">    return 0</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>解析URL参数，从URL中获取某个参数的值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">parse_uri_paras()&#123;</span><br><span class="line">    echo $1 | sed &#39;s&#x2F;.*&#39;$2&#39;&#x3D;\([[:alnum:]]*\).*&#x2F;\1&#x2F;&#39;</span><br><span class="line">    return 0</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取重定向地址</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">request_redirect_url()&#123;</span><br><span class="line">    echo &#96;curl -i &quot;$1&quot; 2&gt;&#x2F;dev&#x2F;null  | sed -n &#39;s&#x2F;^Location:&#x2F;&#x2F;p&#39;&#96;</span><br><span class="line">    return 0</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>发送简单的GET请求</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">http_get()&#123;</span><br><span class="line">    get_data&#x3D;&#96;curl -X GET &quot;$1&quot; 2&gt;&#x2F;dev&#x2F;null&#96;</span><br><span class="line">    if [ &quot;$get_data&quot; &#x3D;  &quot;&quot; ]; then #出错了</span><br><span class="line">            echo &quot;出错了，试试：curl -X GET \&quot;$1\&quot;&quot;</span><br><span class="line">            exit 1</span><br><span class="line">    else </span><br><span class="line">        echo $get_data</span><br><span class="line">        return 0</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>发送简单的POST请求</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">http_post()&#123;</span><br><span class="line">    post_data&#x3D;&#96;curl -X POST -d &quot;$1&quot; $2 2&gt;&#x2F;dev&#x2F;null&#96;</span><br><span class="line">    if [ &quot;$post_data&quot; &#x3D;  &quot;&quot; ]; then #出错了</span><br><span class="line">                echo &quot;出错了，试试：curl -X POST \&quot;$1\&quot; \&quot;$2\&quot;&quot;</span><br><span class="line">                exit 1</span><br><span class="line">        else</span><br><span class="line">                echo $post_data</span><br><span class="line">                return 0</span><br><span class="line">        fi</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://heqiao2010.github.io/2018/06/14/Shell%E5%AE%9E%E7%8E%B0%E7%9A%84%E5%87%A0%E4%B8%AAHttp%E4%BA%A4%E4%BA%92%E7%9A%84%E6%96%B9%E6%B3%95/" data-id="ckgkq4jsa000lhvww3a9j9c9j" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-几道逻辑思维题" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/14/%E5%87%A0%E9%81%93%E9%80%BB%E8%BE%91%E6%80%9D%E7%BB%B4%E9%A2%98/" class="article-date">
  <time datetime="2018-06-14T10:00:00.000Z" itemprop="datePublished">2018-06-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E9%9D%A2%E8%AF%95/">面试</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/14/%E5%87%A0%E9%81%93%E9%80%BB%E8%BE%91%E6%80%9D%E7%BB%B4%E9%A2%98/">几道逻辑思维题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://img.hacpai.com/bing/20180516.jpg?imageView2/1/w/960/h/520/interlace/1/q/10"></p>
<blockquote>
<p>上个月去一个互联网公司面试，三面的时候面试官出了两道思维逻辑题，挺有意思的，这里记录一下。</p>
</blockquote>
<h3 id="1-过河问题"><a href="#1-过河问题" class="headerlink" title="1.过河问题"></a>1.过河问题</h3><ul>
<li>描述：有一条河，河岸边有一个警察，一个犯人，一个父亲和两个儿子，一个母亲和两个女儿，河边只有一条船，这8个人要过河；</li>
<li>约束：<br>  1.能划船的只有警察，父亲和母亲；<br>  2.船上同一时刻只能有两个人，包括小孩；<br>  3.犯人会在警察不在身边的时候伤害其他人，父亲会在母亲不在的时候，伤害女儿，母亲会在父亲不在的时候伤害儿子；</li>
<li>问题：这些人如何过河，才能确保大家都相安无事？</li>
</ul>
<p>思路：把所有的可能情况，全部列一遍就出来了。</p>
<h3 id="2-赛马问题"><a href="#2-赛马问题" class="headerlink" title="2.赛马问题"></a>2.赛马问题</h3><ul>
<li>描述：一共有25匹马，只有5个赛马道，每次赛马只能看出名次，不知道快慢，请问如何比赛才能以最少的次数，选出前3名跑的最快的马？</li>
</ul>
<p>思路：先每5匹分一组，都赛一次，就是5次；然后找出5个第一名，再赛一次，然后淘汰最差的那两组，取倒数第3名那组的第一名，取倒数第4名那组中的前两名，取最快那组中的第二和第三名，恰好就是5匹，再赛一次，取前两名（最快的吗第6次就知道了）就得到结果了，因此是7次。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://heqiao2010.github.io/2018/06/14/%E5%87%A0%E9%81%93%E9%80%BB%E8%BE%91%E6%80%9D%E7%BB%B4%E9%A2%98/" data-id="ckgkq4jsq001shvwwcxpd7lr6" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" rel="tag">面试题</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-面试题记录" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/14/%E9%9D%A2%E8%AF%95%E9%A2%98%E8%AE%B0%E5%BD%95/" class="article-date">
  <time datetime="2018-06-14T10:00:00.000Z" itemprop="datePublished">2018-06-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E9%9D%A2%E8%AF%95/">面试</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/14/%E9%9D%A2%E8%AF%95%E9%A2%98%E8%AE%B0%E5%BD%95/">面试题记录</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://img.hacpai.com/bing/20180407.jpg?imageView2/1/w/960/h/520/interlace/1/q/10"></p>
<blockquote>
<p>今天去某互联网公司面试，从3点一直面试道6点多，面的怎么样倒不清楚，有几道题挺有意思的，这里记录下。</p>
</blockquote>
<p>1.区间合并<br>  写一个方法将如下区间合并：<br>  例如输入：<br>  [1,2],[4,6],[5,8],[10,11]<br>  输出：<br>  [1,2],[4,8],[10,11]<br>  思路：先排序，然后尝试将相邻两个区间合并，遍历整个区间即可；<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public List&lt;Order&gt; merge(List&lt;Order&gt; list)&#123;</span><br><span class="line">  &#x2F;&#x2F;...</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></p>
<p>2.求进行中订单的最大数量<br>  假设订单都有订单ID，开始时间StartTime以及结束时间EndTime（时间单位均是秒），那么如何求某一天24h内，进行中订单的最大数量？<br>  思路：这道题没有想到特别好的思路，直接是用遍历处理的。。。这个可以研究下。。。</p>
<p>3.判断IP是否在IP黑名单中<br>  IP黑名单是有IP地址区间表示的，比如【192.168.100.1，192.168.101.255】，然后有很多个这样的黑名单BlackList，现在要写一个方法，如何快速的判断一个IP地址，是否在这个黑名单中。<br>  思路：IP地址是字符串，字符串比较太慢，可以将IP地址转化为一个整数，这样就相当于判断整数是否在这些区间中了，所以步骤如下：<br>  1）.转化为整数；<br>  2）.将区间排序；<br>  3）.将区间合并；<br>  4）.用二分法查找有序区间，判断是否在区间内。</p>
<hr>
<p>更新：突然想到第二题，可以这样优化：<br>  1）排序<br>  2）然后依次从列表中取区间，进行合并；<br>  3）如果两个区间有交集则计数器加一，区间变成交集区间，再继续，直到和下一个区间没有交集为止，这个时候记录一下这个计数器的值，那么这个值就是已处理过区间中，同时派发订单的最大值，把这个当前最大值放入一个集合；<br>  4）接着重新计数，重新合并区间，知道所有的记录都处理完毕；<br>  5）从计数集合中找出最大值即可。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://heqiao2010.github.io/2018/06/14/%E9%9D%A2%E8%AF%95%E9%A2%98%E8%AE%B0%E5%BD%95/" data-id="ckgkq4jt2002mhvwwg7e56p71" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" rel="tag">面试题</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-关于博客搭建" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/06/12/%E5%85%B3%E4%BA%8E%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/" class="article-date">
  <time datetime="2018-06-12T10:00:00.000Z" itemprop="datePublished">2018-06-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/">杂七杂八</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/06/12/%E5%85%B3%E4%BA%8E%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/">Solo博客搭建</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://img.hacpai.com/bing/20180329.jpg?imageView2/1/w/960/h/520/interlace/1/q/10"> </p>
<blockquote>
<p>用Github Pages可以搭静态博客，可以写点东西，不过不能有人评论，毕竟是静态页面。今天突然想到去年在Godaddy买了个域名一直没有用，今天就索性在搬瓦工买了个linux虚机搭个动态博客试试。</p>
</blockquote>
<h2 id="虚机软件安装"><a href="#虚机软件安装" class="headerlink" title="虚机软件安装"></a>虚机软件安装</h2><p>购买虚机就不用说了，190块/年，买了个最低配的linux虚机，安装了ubuntu12.4系统，动态博客是基于solo搭建的，由于solo是用java开发的，所以先要安装jdk。solo跑起来了之后，发现一个很奇特的现象——80端口不通，但是8080端口是好使的，用netstat查看，没有80端口的TCP链接。latke.properties中的端口不是服务的监听端口，solo服务真正的监听端口是8080，而且没有找到在哪个里面配置的。</p>
<h2 id="nginx配置"><a href="#nginx配置" class="headerlink" title="nginx配置"></a>nginx配置</h2><p>为了解决这个问题，直接装了个nginx，做了个反向代理（老套路…）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">upstream blog &#123;</span><br><span class="line">            server xx.xx.xx.xxx:8080;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">                listen  80;</span><br><span class="line">        server_name heqiao2010.com;</span><br><span class="line">                location &#x2F; &#123;</span><br><span class="line">                    proxy_pass http:&#x2F;&#x2F;blog&#x2F;;</span><br><span class="line">                    proxy_http_version 1.1;</span><br><span class="line">                    proxy_set_header Connection &quot;&quot;;</span><br><span class="line">                    proxy_ignore_client_abort   on;</span><br><span class="line">                    proxy_set_header Host $host:80;</span><br><span class="line">                    proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">                    proxy_set_header X-Forwarded-Proto  $scheme;</span><br><span class="line">                    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">                    proxy_set_header Via &quot;nginx&quot;;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<h2 id="域名映射"><a href="#域名映射" class="headerlink" title="域名映射"></a>域名映射</h2><p>有个没有搞明白的问题是域名映射；在Godaddy上完全看不懂，配置完后，过了一会儿就可以了，估计有缓存。。。</p>
<p><img src="https://raw.githubusercontent.com/heqiao2010/heqiao2010.github.io/master/img/dns.jpg" alt="域名映射" title="dns"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://heqiao2010.github.io/2018/06/12/%E5%85%B3%E4%BA%8E%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/" data-id="ckgkq4jso001khvww8tkidx87" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9C%8D%E5%8A%A1%E7%AB%AF/" rel="tag">服务端</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Centos安装jmeter" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/13/Centos%E5%AE%89%E8%A3%85jmeter/" class="article-date">
  <time datetime="2018-05-13T10:00:00.000Z" itemprop="datePublished">2018-05-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%9C%8D%E5%8A%A1%E7%AB%AF/">服务端</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/13/Centos%E5%AE%89%E8%A3%85jmeter/">CentOs安装Jmeter</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>前段时间公司生产环境，压力增长了不少，后来出过几次性能问题；为了避免高峰期服务器压力过大，导致服务不可用的情况，领导要求每次合入<br>影响性能的代码之后，都需要做压力测试了。<br>我们用jmeter做压力测试，之前是在实验室环境的window上安装图形化的jmeter进行测试，但是由于实验室带宽限制，流量达不到要求，后来就直接在服务器上<br>安装jmeter基于命令行打流；</p>
</blockquote>
<p>#如何在CentOS中安装Jmeter</p>
<ol>
<li><p>Install JRE</p>
<p> <code>yum install java</code></p>
</li>
<li><p>下载jmeter</p>
<p> <code>wget http://mirrors.hust.edu.cn/apache//jmeter/binaries/apache-jmeter-4.0.tgz</code><br> <code>tar zxf apache-jmeter-4.0.tgz</code></p>
</li>
<li><p>拷贝到系统目录</p>
<p> <code>mv apache-jmeter-4.0 /usr/local/</code></p>
</li>
<li><p>修改profile</p>
<p> <code>vim /etc/profile</code></p>
<p> 然后追加：</p>
<p> <code>#/usr/local/apache-jmeter-4.0</code><br> <code>export JMETER=/usr/local/apache-jmeter-4.0/</code><br> <code>export CLASSPATH=$JMETER/lib/ext/ApacheJMeter_core.jar:$JMETER/lib/jorphan.jar:$JMETER/lib/logkit-2.0.jar:$CLASSPATH</code><br> <code>export PATH=$JMETER/bin/:$PATH</code></p>
<p> 然后source生效<br> <code>source /etc/profile</code></p>
</li>
<li><p>验证</p>
</li>
</ol>
<p><code>[?]# jmeter -v</code><br><code>May 12, 2018 9:44:30 AM java.util.prefs.FileSystemPreferences$1 run</code></p>
<p><code>INFO: Created user preferences directory.</code><br><code>_ ____ _ ____ _ _ _____ _ __ __ _____ _____ _____ ____</code><br><code>/ \ | _ \ / \ / ___| | | | ____| | | \/ | ____|_ _| ____| _ \</code><br><code>/ _ \ | |_) / _ \| | | |_| | _| _ | | |\/| | _| | | | _| | |_) |</code><br><code>/ ___ \| __/ ___ \ |___| _ | |___ | |_| | | | | |___ | | | |___| _ &lt;</code><br><code>/_/ \_\_| /_/ \_\____|_| |_|_____| \___/|_| |_|_____| |_| |_____|_| \_\ 4.0 r1823414</code><br><code>Copyright (c) 1999-2018 The Apache Software Foundation</code></p>
<ol>
<li><p>如何基于命令行运行</p>
<p> <code>jmeter -n -t test1.jmx -l result.log 2&gt;/dev/null</code></p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://heqiao2010.github.io/2018/05/13/Centos%E5%AE%89%E8%A3%85jmeter/" data-id="ckgkq4jru0000hvww9rx02m6w" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9C%8D%E5%8A%A1%E7%AB%AF/" rel="tag">服务端</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Java中锁简单使用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/13/Java%E4%B8%AD%E9%94%81%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/" class="article-date">
  <time datetime="2018-05-13T10:00:00.000Z" itemprop="datePublished">2018-05-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%9C%8D%E5%8A%A1%E7%AB%AF/">服务端</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/13/Java%E4%B8%AD%E9%94%81%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/">Java中锁的使用</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>工作3年多了，写过一点点Java代码，用过sychronized，不过确实没有用过Lock这个东西，今天抽时间看看。</p>
</blockquote>
<p>其实Lock是个接口：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public interface Lock &#123;</span><br><span class="line">	 &#x2F;&#x2F; 获取锁，如果锁被占用，则等待；</span><br><span class="line">    void lock();</span><br><span class="line">    &#x2F;&#x2F; </span><br><span class="line">    void lockInterruptibly() throws InterruptedException;</span><br><span class="line">    boolean tryLock();</span><br><span class="line">    boolean tryLock(long time, TimeUnit unit) throws InterruptedException;</span><br><span class="line">    void unlock();</span><br><span class="line">    Condition newCondition();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://heqiao2010.github.io/2018/05/13/Java%E4%B8%AD%E9%94%81%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/" data-id="ckgkq4js4000ahvwwcb2s05nx" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-某公司两道面试题" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/13/%E6%9F%90%E5%85%AC%E5%8F%B8%E4%B8%A4%E9%81%93%E9%9D%A2%E8%AF%95%E9%A2%98/" class="article-date">
  <time datetime="2018-05-13T10:00:00.000Z" itemprop="datePublished">2018-05-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E9%9D%A2%E8%AF%95/">面试</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/13/%E6%9F%90%E5%85%AC%E5%8F%B8%E4%B8%A4%E9%81%93%E9%9D%A2%E8%AF%95%E9%A2%98/">某公司两道面试题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>今天下午接到某公司笔试的通知，面试官发过来一个链接，打开之后，发现是两道笔试题，看似简单，但是打完之后，<br>面试官直接关了页面，结果可想而知，这里分享一下这两道题，后面想想更好的解决方案。</p>
</blockquote>
<ol>
<li>查找整数<br>输入：一个有序数组array，一个整数n<br>输出：如果n在array里，输出n的位置；如果n不在array中输出n可以插入的位置，插入后的数组仍然有序<br>例如：  </li>
</ol>
<p>*[1,3,5,6], 5 → 2<br>*[1,3,5,6], 2 → 1<br>*[1,3,5,6], 7 → 4<br>*[1,3,5,6], 0 → 0  </p>
<p>我的答案：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 默认升序，如果降序需要反过来</span><br><span class="line">public int findPosition(int arr[], int n)&#123;</span><br><span class="line"> int min &#x3D; 0;</span><br><span class="line">    int max &#x3D; arr.length - 1;</span><br><span class="line">  </span><br><span class="line">   if(null &#x3D;&#x3D; arr || arr.length &#x3D;&#x3D; 0)&#123;</span><br><span class="line">     return -1; </span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">   if(n &gt; arr[max])&#123;</span><br><span class="line">     return max + 1;</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">   if(n &#x3D;&#x3D; arr[max])&#123;</span><br><span class="line">     return max;</span><br><span class="line">     &#125;</span><br><span class="line">  </span><br><span class="line">   if(n &lt;&#x3D; arr[min])&#123;</span><br><span class="line">     return min;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">   while(max - min &gt; 1)&#123;</span><br><span class="line">     int newIndex &#x3D; (max + min) &#x2F; 2;</span><br><span class="line">       if(arr[newIndex] &gt; n)&#123;</span><br><span class="line">         &#x2F;&#x2F;取小区间</span><br><span class="line">           max &#x3D; newIndex;</span><br><span class="line">        &#125; else if(arr[newIndex] &lt; n)&#123;</span><br><span class="line">         &#x2F;&#x2F;取大区间</span><br><span class="line">           min &#x3D; newIndex;</span><br><span class="line">        &#125; else&#123;</span><br><span class="line">         &#x2F;&#x2F;相等，找到了</span><br><span class="line">           return newIndex;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">   if(arr[max] &#x3D;&#x3D; n)&#123;</span><br><span class="line">     return max;</span><br><span class="line">    &#125; else if(arr[min] &#x3D;&#x3D; n)&#123;</span><br><span class="line">     return min;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">     &#x2F;&#x2F; 可以插入位置在min后</span><br><span class="line">     return min + 1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>分析：<br>上面只是做了一个简单的二分查找，有没有更优的解决方案，后面还需要再研究下。</p>
<ol start="2">
<li>字符串查找<br>输入: 字符串str1， 字符串str2<br>输出: 字符串str2在字符串str1中第一次出现的位置。如果没有返回-1.<br>例如： str1=“<a target="_blank" rel="noopener" href="http://www.taobao.com”/">www.taobao.com”</a> str2=”taobao” -&gt; 4<br>其它要求：不能使用String类的indexOf方法  </li>
</ol>
<p>我的答案：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">public class Solution &#123;</span><br><span class="line">    public int strStr(String str1, String str2) &#123;</span><br><span class="line">     if(null &#x3D;&#x3D; str1 || null &#x3D;&#x3D; str2 || str1.length()&lt;str2.length())&#123;</span><br><span class="line">         return -1;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">     int i &#x3D; 0; &#x2F;&#x2F; str1 p1</span><br><span class="line">        while(i&lt;str1.length())&#123;</span><br><span class="line">         int j &#x3D; 0; &#x2F;&#x2F; str2 p2</span><br><span class="line">         while( str1.length() &gt;&#x3D; (i + j) </span><br><span class="line">             &amp;&amp; str1.charAt(i + j) &#x3D;&#x3D; str2.charAt(j))&#123;</span><br><span class="line">                j++;</span><br><span class="line">                if(j &#x3D;&#x3D; str2.length())&#123;</span><br><span class="line">                 return i;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; </span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">      return -1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>分析：<br>我的答案只是传统的字符串匹配方式，大学里面学的KMP早已忘记，很尴尬，😅。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://heqiao2010.github.io/2018/05/13/%E6%9F%90%E5%85%AC%E5%8F%B8%E4%B8%A4%E9%81%93%E9%9D%A2%E8%AF%95%E9%A2%98/" data-id="ckgkq4jsw002ahvwwevznaum4" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" rel="tag">面试题</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-newstart" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/06/newstart/" class="article-date">
  <time datetime="2018-05-06T03:00:00.000Z" itemprop="datePublished">2018-05-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/">杂七杂八</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/06/newstart/">一个全新的开始</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>总算搬新家了，自如的房子有点贵。。。</p>
</blockquote>
<h2 id="只看下桌子吧"><a href="#只看下桌子吧" class="headerlink" title="只看下桌子吧"></a>只看下桌子吧</h2><p><img src="https://raw.githubusercontent.com/heqiao2010/heqiao2010.github.io/master/img/etc/ziru.jpeg" alt="插件提示" title="桌子"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://heqiao2010.github.io/2018/05/06/newstart/" data-id="ckgkq4jsn001ihvwwf91t6edw" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9D%82%E8%B0%88/" rel="tag">杂谈</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/2/">&amp;laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Arthas/">Arthas</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Freemarker/">Freemarker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java%E5%B9%B6%E5%8F%91%E5%9F%BA%E7%A1%80/">Java并发基础</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mysql/">Mysql</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring/">Spring</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Swagger/">Swagger</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/logrotate/">logrotate</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/nginx/">nginx</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/syslog/">syslog</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%8D%E5%8A%A1%E7%AB%AF/">服务端</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/">杂七杂八</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%99%9A%E6%8B%9F%E6%9C%BA/">虚拟机</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9D%A2%E8%AF%95/">面试</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Api%E7%AE%A1%E7%90%86/" rel="tag">Api管理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Arthas/" rel="tag">Arthas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Freemarker/" rel="tag">Freemarker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Maven/" rel="tag">Maven</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySql/" rel="tag">MySql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring/" rel="tag">Spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VirtualBox/" rel="tag">VirtualBox</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/" rel="tag">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BB%A3%E7%A0%81%E7%BB%9F%E8%AE%A1/" rel="tag">代码统计</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%8D%E5%8A%A1%E7%AB%AF/" rel="tag">服务端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82%E8%B0%88/" rel="tag">杂谈</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" rel="tag">面试题</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Api%E7%AE%A1%E7%90%86/" style="font-size: 10px;">Api管理</a> <a href="/tags/Arthas/" style="font-size: 10px;">Arthas</a> <a href="/tags/Freemarker/" style="font-size: 12.5px;">Freemarker</a> <a href="/tags/Java/" style="font-size: 20px;">Java</a> <a href="/tags/Maven/" style="font-size: 10px;">Maven</a> <a href="/tags/MySql/" style="font-size: 10px;">MySql</a> <a href="/tags/Spring/" style="font-size: 15px;">Spring</a> <a href="/tags/VirtualBox/" style="font-size: 10px;">VirtualBox</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/%E4%BB%A3%E7%A0%81%E7%BB%9F%E8%AE%A1/" style="font-size: 10px;">代码统计</a> <a href="/tags/%E6%9C%8D%E5%8A%A1%E7%AB%AF/" style="font-size: 17.5px;">服务端</a> <a href="/tags/%E6%9D%82%E8%B0%88/" style="font-size: 10px;">杂谈</a> <a href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" style="font-size: 15px;">面试题</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">二月 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/06/30/Spring_Security%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E7%9A%84%E8%BF%87%E6%BB%A4%E6%8E%89%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2%E8%AF%B7%E6%B1%82/">Spring Security 如何优雅的过滤掉静态页面请求</a>
          </li>
        
          <li>
            <a href="/2020/06/17/%E5%BF%97%E5%BD%92%E6%A1%A3%E5%B7%A5%E5%85%B7logrotate%E4%BB%8B%E7%BB%8D/">日志归档工具logrotate介绍</a>
          </li>
        
          <li>
            <a href="/2019/07/26/Freemarker%E4%B8%AD%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8CJson%E8%BD%AC%E5%8C%96/">Freemarker中如何进行Json转化</a>
          </li>
        
          <li>
            <a href="/2019/07/08/ControllerAdvice%E6%B3%A8%E8%A7%A3/">ControllerAdvice注解</a>
          </li>
        
          <li>
            <a href="/2019/07/02/Spring%E5%AD%A6%E4%B9%A0%E4%B9%8BProfile%E5%92%8CLookup%E6%B3%A8%E8%A7%A3/">Spring学习之Profile和Lookup注解</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 heqiao2010<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>